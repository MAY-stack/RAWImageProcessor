<!DOCTYPE html>
<HTML>

<HEAD>
    <TITLE>SIMPLE RAW PROCESSOR</TITLE>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        //íŒŒì¼ ì„ íƒ ë¶€ë¶„
        $("#inFile").on('change', function () {
            var fileName = $("#inFile").val();
            $(".upload-name").val(fileName);
        });

        // íƒ­ ë©”ë‰´ ì„ íƒ ì²˜ë¦¬ ë¶€ë¶„//
        $(document).ready(function () {
            $('ul.tabs li').click(function () {
                var tab_id = $(this).attr('data-tab');

                $('ul.tabs li').removeClass('current');
                $('.tab-content').removeClass('current');

                $(this).addClass('current');
                $("#" + tab_id).addClass('current');
            })
        })


    </script>

    <script>    // ë¼ë””ì˜¤ë²„íŠ¼ onchange valueë¥¼ selectAlgo()ë¡œ ì „ë‹¬

        $(document).ready(function () {
            $('input[type=radio][name="basic"]').change(function () {
                if (inImage == null) {
                    alert("íŒŒì¼ì´ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\níŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”.");
                } else {
                    selectAlgo(this.value);
                }
            });
        });
    </script>

    <script lang="javascript">

        // ì „ì—­ ë³€ìˆ˜ë¶€
        var inCanvas, inCtx, outCanvas, outCtx;
        var inImage, inH, inW; // ì…ë ¥ íŒŒì¼, ì…ë ¥ ë°°ì—´, ì…ë ¥í­ê³¼ ë†’ì´
        inImage = inH = inW = null;

        var outImage, outH, outW; // ì¶œë ¥ íŒŒì¼, ì¶œë ¥ ë°°ì—´, ì¶œë ¥í­ê³¼ ë†’ì´
        var tempHistoGram, histoGram;
        var svImage, svH, svW;
        var originImage, orignH, originW;
        var inPaper, outPaper; // ì¢…ì´
        var inFile;
        var mask;
        var blur_mask = [[1 / 9.0, 1 / 9.0, 1 / 9.0],
                        [1 / 9.0, 1 / 9.0, 1 / 9.0],
                        [1 / 9.0, 1 / 9.0, 1 / 9.0]];

        var gaussian_mask = [[1 / 16.0, 1 / 8.0, 1 / 16.0],
        [1 / 8.0, 1 / 4.0, 1 / 8.0],
        [1 / 16.0, 1 / 8.0, 1 / 16.0]];

        var edge_mask = [[0.0, -1.0, 0.0],
        [-1.0, 2.0, 0.0],
        [0.0, 0.0, 0.0]];

        var sharpen1_mask = [[ 0.0, -1.0,  0.0],
                             [-1.0,  5.0, -1.0],
                             [ 0.0, -1.0,  0.0]];

        var sharpen2_mask = [[-1.0, -1.0, -1.0],
                             [-1.0,  9.0, -1.0],
                             [-1.0, -1.0, -1.0]];

        // í•¨ìˆ˜ ì„ ì–¸ë¶€
        //////////////////////
        //// ê³µí†µ í•¨ìˆ˜ë¶€
        //////////////////////
        function init() {
            inCanvas = document.getElementById("inCanvas"); // ë„í™”ì§€ì— ì ‘ê·¼
            inCtx = inCanvas.getContext('2d'); // ë¬¼ê°, ë¶“ì´ ë“¤ì€ í†µ
            outCanvas = document.getElementById("outCanvas"); // ë„í™”ì§€ì— ì ‘ê·¼
            outCtx = outCanvas.getContext('2d'); // ë¬¼ê°, ë¶“ì´ ë“¤ì€ í†µ
        }

        function openRawImage() {
            inFile = document.getElementById("inFile").files[0]; // Lena256.raw
            // (ì¤‘ìš”!) ì´ë¯¸ì§€ì˜ í­ê³¼ ë†’ì´ë¥¼ ê³„ì‚°
            inH = inW = Math.floor(Math.sqrt(inFile.size));
            //  ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ë©”ëª¨ë¦¬ í™•ë³´
            inImage = new Array(inH);
            for (var i = 0; i < inH; i++)
                inImage[i] = new Array(inW);
            // ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì ˆ
            inCanvas.height = inH;
            inCanvas.width = inW;

            outH = inH;
            outW = inW;

            // RAW íŒŒì¼ --> ë©”ëª¨ë¦¬(ë°°ì—´)ë¡œ ë¡œë”©
            var reader = new FileReader(); // íŒŒì¼ ê°ì²´
            reader.readAsBinaryString(inFile);
            reader.onload = function () {  // ìµëª… í•¨ìˆ˜
                var blob = reader.result; // íŒŒì¼ì„ í•œ ë©ì–´ë¦¬(blob)ì— ë„£ê¸°
                // blobì—ì„œ í•œì í•œì (256x256) ì”© ë½‘ì•„ì„œ 2ì°¨ì› ë°°ì—´ì— ë„£ê¸°
                for (var i = 0; i < inH; i++) {
                    for (var k = 0; k < inW; k++) {
                        var sPixel = (i * inH + k); // ì‹œì‘ ìœ„ì¹˜
                        var ePixel = (i * inH + k) + 1; // ë ìœ„ì¹˜
                        inImage[i][k] = blob.slice(sPixel, ePixel).charCodeAt(0); // í•œì ë§Œ ì°ì–´ë‚´ê¸°. 'ëº‡'--> 253
                    }
                }
                //orginImage ì €ì¥
                //  ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ë©”ëª¨ë¦¬ í™•ë³´
                originH = inH;
                originW = inW;
                originImage = new Array(originH);
                for (var i = 0; i < originH; i++)
                    originImage[i] = new Array(originW);
                originImage = inImage;      //originImageì— ì›ë˜ ì‚¬ì§„ ì €ì¥
                displayInImage();
            }
        }

        //inImage ë””ìŠ¤í”Œë ˆì´
        function displayInImage() {
            // ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì ˆ
            inCanvas.height = inH;
            inCanvas.width = inW;
            // ì…ë ¥ ë©”ëª¨ë¦¬ë¥¼ ì¢…ì´ì— ì½•ì½•ì½• ì°ê¸°...
            inPaper = inCtx.createImageData(inH, inW); // ë¹ˆ ì¢…ì´ ì¤€ë¹„
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    var px = inImage[i][k];
                    inPaper.data[(i * inH + k) * 4 + 0] = px; // R
                    inPaper.data[(i * inH + k) * 4 + 1] = px; // G
                    inPaper.data[(i * inH + k) * 4 + 2] = px; // B
                    inPaper.data[(i * inH + k) * 4 + 3] = 255; // Alpha
                }
            }
            inCtx.putImageData(inPaper, 0, 0); // ì¢…ì´ë¥¼ ìº”ë²„ìŠ¤ ì™¼ìª½ìœ„ì— ë”± ë¶™ì—¬ì„œ ë¶€ì°©.
        }

        //processing í•œ outImage ë””ìŠ¤í”Œë ˆì´
        function displayImage() {
            // ì¶œë ¥ ë©”ëª¨ë¦¬ë¥¼ ì¢…ì´ì— ì½•ì½•ì½• ì°ê¸°...
            outPaper = outCtx.createImageData(outH, outW); // ë¹ˆ ì¢…ì´ ì¤€ë¹„
            // ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì ˆ
            outCanvas.height = outH;
            outCanvas.width = outW;

            for (var i = 0; i < outH; i++) {
                for (var k = 0; k < outW; k++) {
                    var px = outImage[i][k];
                    outPaper.data[(i * outH + k) * 4 + 0] = px; // R
                    outPaper.data[(i * outH + k) * 4 + 1] = px; // G
                    outPaper.data[(i * outH + k) * 4 + 2] = px; // B
                    outPaper.data[(i * outH + k) * 4 + 3] = 255; // Alpha
                }
            }
            outCtx.putImageData(outPaper, 0, 0); // ì¢…ì´ë¥¼ ìº”ë²„ìŠ¤ ì™¼ìª½ìœ„ì— ë”± ë¶™ì—¬ì„œ ë¶€ì°©.
        }
        //ì²˜ë¦¬ ì ìš© : outImage->inImageë¡œ ì‚¬ìš©
        function imageSaving(outImage, outH, outW) {
            svH = outH;
            svW = outW;

            //ì €ì¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹
            svImage = new Array(svH);
            for (var i = 0; i < svH; i++) svImage[i] = new Array(svW);

            // outImageì—ì„œ í•œì í•œì  ì”© ë½‘ì•„ì„œ svImage ë°°ì—´ì— ë„£ê¸°
            for (var i = 0; i < outH; i++) {
                for (var k = 0; k < outW; k++) {
                    svImage[i][k] = outImage[i][k];
                }
            }
            inH = svH;
            inW = svW;
            inImage = svImage;
            displayInImage();
        }
        //ì´ˆê¸°í™” : inImage ì›ë˜ ì—´ì—ˆë˜ ìƒíƒœë¡œ ë³µê·€
        function resetImage() {
            inH = originH;
            inW = originW;

            inImage = originImage;
            displayInImage();
        }
        //////////////////////
        //// *** ì˜ìƒ ì²˜ë¦¬ í•¨ìˆ˜ë¶€
        //////////////////////

        function selectAlgo(selectNum) {        //ì•Œê³ ë¦¬ì¦˜ select case
            switch (parseInt(selectNum)) {
                case 100: equal_image(); break;
                case 101: add_image(); break;
                case 102: reverse_image(); break;
                case 103: mono_127(); break;
                case 104: mono_avg(); break;
                case 105: mono_mid(); break;


                case 201: rot_90(); break;
                case 202: rot_180(); break;
                case 203: rot_270(); break;
                case 221: rvs_UpDown(); break;
                case 222: rvs_LeftRight(); break;

                case 251: rot_N(); break;
                case 252: rot_N_centerBack(); break;

                case 301: zoomIn2_image(); break;
                case 302: zoomOut2_image(); break;
                case 303: zoomIn_image(); break;
                case 304: zoomOut_image(); break;

                case 400: draw_Histogram(); break;
                case 401: histoSt_image(); break;
                case 402: endIn_image(); break;
                case 403: histoEqual_image(); break;

                case 501: embos_image(); break;
                case 502: mask = blur_mask; masking_image(); break;
                case 503: mask = gaussian_mask; masking_image(); break;
                case 504: mask = edge_mask; masking_image(); break;
                case 505: mask = sharpen1_mask; masking_image(); break;
                case 506: mask = sharpen2_mask; masking_image(); break;

                case 999: adj_Trns(); break;
            }
        }

        function equal_image() {    //ë™ì¼ ì˜ìƒ  
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;
            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);
            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    outImage[i][k] = inImage[i][k];
                }
            }
            // *******************************
            displayImage();
        }

        function add_image() {      //ë°ê¸° ì¡°ì ˆ 
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;
            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);
            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **
            var value = parseInt(prompt("ì¡°ì ˆì„ ì›í•˜ëŠ” ê°’ì„ ì…ë ¥í•˜ì„¸ìš”. (ìµœì†Œ -100, ìµœëŒ€ 100)", "50"));
            while (parseInt(value) < -100 || parseInt(value) > 100) {
                alert('-100 ~ 100 ì‚¬ì´ì˜ ê°’ì„ ì…ë ¥í•˜ì„¸ìš”.');
                value = parseInt(prompt("ì¡°ì ˆì„ ì›í•˜ëŠ” ê°’ì„ ì…ë ¥í•˜ì„¸ìš”. (ìµœì†Œ -100, ìµœëŒ€ 100)"));
            }

            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    if (inImage[i][k] + value < 0)
                        outImage[i][k] = 0;
                    else if (inImage[i][k] + value > 255)
                        outImage[i][k] = 255;
                    else
                        outImage[i][k] = inImage[i][k] + value;
                }
            }
            // *******************************
            displayImage();
        }

        function reverse_image() {      //ë°˜ì „  
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;
            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);
            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    outImage[i][k] = 255 - inImage[i][k];
                }
            }
            // *******************************
            displayImage();
        }

        function mono_127() {       //í‘ë°±  (value 127)
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;

            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);

            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **    
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    if (inImage[i][k] < 127) {
                        outImage[i][k] = 0;
                    } else {
                        outImage[i][k] = 255;
                    }
                }
            }
            // *******************************
            displayImage();
        }

        function mono_avg() {       //í‘ë°±  (average ê¸°ì¤€)
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;

            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);

            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ ** 
            var sum = 0;        //í‰ê· ê°’ avg êµ¬í•˜ê¸°
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    sum += inImage[i][k];
                }
            }
            var avg = sum / (inH * inW);

            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    if (inImage[i][k] < avg) {
                        outImage[i][k] = 0;
                    } else {
                        outImage[i][k] = 255;
                    }
                }
            }
            // *******************************
            displayImage();
        }

        function mono_mid() {       //í‘ë°±  (ì¤‘ê°„ê°’ ê¸°ì¤€)
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;

            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);

            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ ** 
            //ì¤‘ê°„ê°’ êµ¬í•˜ê¸° : 2ì°¨ë°°ì—´ 1ì°¨ì—´í™” -> sort -> ì¤‘ê°„ê°’ ì„ íƒ
            var mid_value = 0;

            var oneArray = new Array(inH * inW);       // 2ì°¨ ë°°ì—´ 1ì°¨ì—´í™”
            var index = 0;
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    oneArray[index++] = inImage[i][k];
                }
            }
            oneArray.sort();        //ë°°ì—´ì˜ ì›ì†Œ ì •ë ¬
            mid_value = oneArray[parseInt((inH * inW) / 2)];    //ì¤‘ê°„ê°’ ë½‘ê¸°

            for (var i = 0; i < inH; i++) {      //í‘ë°±í™” ì²˜ë¦¬
                for (var k = 0; k < inW; k++) {
                    if (inImage[i][k] < mid_value) {
                        outImage[i][k] = 0;
                    } else {
                        outImage[i][k] = 255;
                    }
                }
            }
            // *******************************
            displayImage();
        }

        function rot_90() {     //90ë„ íšŒì „ 
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;

            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);

            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **    
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    var r_i = k;
                    var r_k = inH - i - 1;
                    outImage[r_i][r_k] = inImage[i][k];
                }
            }
            // *******************************
            displayImage();
        }

        function rot_180() {        //180ë„ íšŒì „
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;

            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);

            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **    
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    var r_i = Math.abs(i - inH + 1);
                    var r_k = Math.abs(k - inW + 1);
                    outImage[r_i][r_k] = inImage[i][k];
                }
            }
            // *******************************
            displayImage();
        }

        function rot_270() {        //270ë„ íšŒì „ 
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;

            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);

            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **    
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    var r_i = Math.abs(k - inH + 1);
                    var r_k = i;
                    outImage[r_i][r_k] = inImage[i][k];
                }
            }
            // *******************************
            displayImage();
        }

        function rot_N() {    //íšŒì „ 
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;
            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);
            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **
            var angle = parseInt(prompt("íšŒì „ì„ ì›í•˜ëŠ” ê°ë„", "45"));
            angle = angle * Math.PI / 180;
            // ê³µì‹
            // new_i = cos*i - sin*k
            // new_k = sin*i + cos*k
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    var new_i = parseInt(Math.cos(angle) * i - Math.sin(angle) * k);
                    var new_k = parseInt(Math.sin(angle) * i + Math.cos(angle) * k);
                    if (((0 <= new_i) && (new_i < outH)) && ((0 <= new_k) && (new_k < outW))) {
                        outImage[new_i][new_k] = inImage[i][k];
                    }
                }
            }
            // *******************************
            displayImage();
        }

        function rot_N_centerBack() {    //íšŒì „ 
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;
            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);
            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **
            var angle = parseInt(prompt("ê°ë„", "45"));
            angle = angle * Math.PI / 180;
            // ê³µì‹
            // new_i = cos*(i-cx) - sin*(k-cy) + cx
            // new_k = sin*(i-cx) + cos*(k-cy) + cy
            var cx = parseInt(inH / 2);
            var cy = parseInt(inW / 2);

            for (var i = 0; i < outH; i++) {
                for (var k = 0; k < outW; k++) {
                    var old_i = parseInt(Math.cos(angle) * (i - cx) + Math.sin(angle) * (k - cy) + cx);
                    var old_k = parseInt(-Math.sin(angle) * (i - cx) + Math.cos(angle) * (k - cy) + cy);
                    if (((0 <= old_i) && (old_i < inH)) && ((0 <= old_k) && (old_k < inW))) {
                        outImage[i][k] = inImage[old_i][old_k];
                    }
                }
            }
            // *******************************
            displayImage();
        }

        function rvs_UpDown() {     //ìƒí•˜ ë°˜ì „ 
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;

            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);

            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **    
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    m_i = Math.abs(i - inH + 1);
                    outImage[i][k] = inImage[m_i][k];
                }
            }
            // *******************************
            displayImage();
        }

        function rvs_LeftRight() {      //ì¢Œìš° ë°˜ì „
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;

            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);

            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **    
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    m_k = Math.abs(k - inW + 1);
                    outImage[i][k] = inImage[i][m_k];
                }
            }
            // *******************************
            displayImage();
        }

        function zoomIn2_image() {      // 2ë°° í™•ëŒ€
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒ í¬ê¸° ê²°ì •
            outH = parseInt(2 * inH);
            outW = parseInt(2 * inW);

            // ì¶œë ¥ ì˜ìƒ ë©”ëª¨ë¦¬ í™•ë³´
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);
            //ì˜ìƒ ì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜
            for (i = 0; i < inH; i++) {
                for (k = 0; k < inW; k++) {
                    outImage[2 * i][2 * k] = inImage[i][k];
                    outImage[2 * i][2 * k + 1] = inImage[i][k];
                    outImage[2 * i + 1][2 * k] = inImage[i][k];
                    outImage[2 * i + 1][2 * k + 1] = inImage[i][k];
                }
            }
            // *******************************
            displayImage();
        }

        function zoomOut2_image() {     // 1/2ë¡œ ì¶•ì†Œ
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒ í¬ê¸° ê²°ì •
            outH = parseInt(inH / 2);
            outW = parseInt(inW / 2);

            // ì¶œë ¥ ì˜ìƒ ë©”ëª¨ë¦¬ í™•ë³´
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);

            //ì˜ìƒ ì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜
            for (i = 0; i < outH; i++) {
                for (k = 0; k < outW; k++) {
                    outImage[i][k] = Math.floor((inImage[2 * i][2 * k] + inImage[2 * i][2 * k + 1] + inImage[2 * i + 1][2 * k] + inImage[2 * i + 1][2 * k + 1]) / 4);
                }
            }
            // *******************************
            displayImage();
        }

        function zoomIn_image() {      // í™•ëŒ€
            //í™•ëŒ€ í•  ì¡°ì • ê°’ ì…ë ¥ ë°›ê¸°
            var scale = parseInt(prompt("í™•ëŒ€ë¥¼ ì›í•˜ëŠ” ë°°ìœ¨ì„ ì…ë ¥í•˜ì„¸ìš”.", "2"));
            /*while (parseInt(adj_value)) {
                alert('ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                var adj_value = prompt("í™•ëŒ€ë¥¼ ì›í•˜ëŠ” ë°°ìœ¨ì„ ì…ë ¥í•˜ì„¸ìš”." ,"2");
            }*/

            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒ í¬ê¸° ê²°ì •
            outH = parseInt(inH * scale);
            outW = parseInt(inW * scale);

            // ì¶œë ¥ ì˜ìƒ ë©”ëª¨ë¦¬ í™•ë³´
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);
            //ì˜ìƒ ì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜    //ë°±ì›Œë”© ì ìš©
            for (i = 0; i < outH; i++) {
                for (k = 0; k < outW; k++) {
                    //outImage[i][k]= inImage[Math.floor(i/scale)][Math.floor(k/scale)];
                    outImage[i][k] = inImage[parseInt(i / scale)][parseInt(k / scale)];
                }
            }
            // *******************************
            displayImage();
        }

        function zoomOut_image() {      // ì¶•ì†Œ
            //ì¶•ì†Œ í•  ì¡°ì • ê°’ ì…ë ¥ ë°›ê¸°
            var scale = parseInt(prompt("ì¶•ì†Œë¥¼ ì›í•˜ëŠ” ë°°ìœ¨ì„ 2ì˜ ë°°ìˆ˜ë¡œ ì…ë ¥í•˜ì„¸ìš”.", "2"));
            while (parseInt(value) % 2 == 0) {
                alert('ì§ìˆ˜ë¡œë§Œ ì¶•ì†Œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                scale = parseInt(prompt("ì¶•ì†Œë¥¼ ì›í•˜ëŠ” ë°°ìœ¨ì„ 2ì˜ ë°°ìˆ˜ë¡œ ì…ë ¥í•˜ì„¸ìš”."));
            }

            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒ í¬ê¸° ê²°ì •
            outH = parseInt(inH / scale);
            outW = parseInt(inW / scale);

            // ì¶œë ¥ ì˜ìƒ ë©”ëª¨ë¦¬ í™•ë³´
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);
            // ìº”ë²„ìŠ¤ í¬ê¸° ë³€ê²½
            outCanvas.height = outH;
            outCanvas.width = outW;
            //ì˜ìƒ ì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜
            for (i = 0; i < inH; i++) {
                for (k = 0; k < inW; k++) {
                    outImage[parseInt(i / scale)][parseInt(k / scale)] = inImage[i][k];
                }
            }
            // *******************************
            displayImage();
        }

        function adj_Trns() {        //íˆ¬ëª…ë„ ì¡°ì ˆ
            //íˆ¬ëª…ë„ ì¡°ì • ê°’ ì…ë ¥ ë°›ê¸°
            var adj_value = prompt("ì¡°ì ˆì„ ì›í•˜ëŠ” íˆ¬ëª…ë„ë¥¼ ì…ë ¥í•˜ì„¸ìš”. (0 ~ 100%)", "50");
            while (parseInt(adj_value) < 0 || parseInt(adj_value) > 100) {
                alert('0 ~ 100 ì‚¬ì´ì˜ ê°’ì„ ì…ë ¥í•˜ì„¸ìš”.');
                var adj_value = prompt("ì¡°ì ˆì„ ì›í•˜ëŠ” íˆ¬ëª…ë„ë¥¼ ì…ë ¥í•˜ì„¸ìš”. (0 ~ 100%)", "50");
            }
            adj_value = (100 - parseInt(adj_value)) * 2.55;

            equal_image();  //ë™ì¼ ì˜ìƒì˜ ë°ì´í„° ê°€ì ¸ì˜´

            // ì¶œë ¥ ë©”ëª¨ë¦¬ë¥¼ ì¢…ì´ì— ì½•ì½•ì½• ì°ê¸°...                
            outPaper = outCtx.createImageData(outH, outW); // ë¹ˆ ì¢…ì´ ì¤€ë¹„
            // ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì ˆ
            outCanvas.height = outH;
            outCanvas.width = outW;

            for (var i = 0; i < outH; i++) {
                for (var k = 0; k < outW; k++) {
                    var px = outImage[i][k];
                    outPaper.data[(i * outH + k) * 4 + 0] = px; // R
                    outPaper.data[(i * outH + k) * 4 + 1] = px; // G
                    outPaper.data[(i * outH + k) * 4 + 2] = px; // B
                    outPaper.data[(i * outH + k) * 4 + 3] = adj_value; // Alpha
                }
            }
            outCtx.putImageData(outPaper, 0, 0); // ì¢…ì´ë¥¼ ìº”ë²„ìŠ¤ ì™¼ìª½ìœ„ì— ë”± ë¶™ì—¬ì„œ ë¶€ì°©.
        }

        //íˆìŠ¤í† ê·¸ë¨ ê·¸ë¦¬ê¸° í•¨ìˆ˜
        function draw_Histogram() {        // íˆìŠ¤í† ê·¸ë¨ ê·¸ë¦¬ê¸°
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = outW = 256;
            // íˆìŠ¤í† ê·¸ë¨ ê·¸ë¦´ ë©”ëª¨ë¦¬ í• ë‹¹.
            tempHistoGram = new Array(256);
            for (var i = 0; i < 256; i++)
                tempHistoGram[i] = new Array(256);

            histoGram = new Array(256);
            for (var i = 0; i < 256; i++)
                histoGram[i] = new Array(256);
            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **
            //1 ë‹¨ê³„ : íˆìŠ¤í† ê·¸ë¨ ìƒì„±
            var histo = new Array(256);     //íˆìŠ¤í† ê·¸ë¨ ë°ê¸°ì˜ ê°’ì˜ ê°œìˆ˜ê°€ ë“¤ì–´ê°ˆ ë°°ì—´ ìƒì„±
            for (var i = 0; i < 256; i++) {      //ì´ˆê¸°í™”
                histo[i] = 0;
            }

            for (var i = 0; i < inH; i++) {     //inImage ê° ì›ì†Œì˜ ë°ê¸° ë°ì´í„°ì— í•´ë‹¹í•˜ëŠ” íˆìŠ¤í† ê·¸ë¨ì˜ ì›ì†Œê°€ 1ì”© ì¦ê°€
                for (var k = 0; k < inW; k++) {
                    histo[inImage[i][k]]++;
                }
            }

            let high = histo[0];        //ì´ë¯¸ì§€ì—ì„œ í”½ì…€ì˜ ê°œìˆ˜ê°€ ê°€ì¥ ë§ì€ ë°ê¸°ì˜ ê°œìˆ˜ í™•ì¸
            for (var i = 0; i < 256; i++) {
                if (histo[i] > high)
                    high = histo[i];
            }

            for (var i = 0; i < 256; i++) {     //ê°€ì¥ ê°œìˆ˜ê°€ ë§ì€ ê²ƒ ê¸°ì¤€ìœ¼ë¡œ ê·¸ë˜í”„ í˜•íƒœ ê·¸ë¦¬ê¸°
                for (var k = 0; k < 256; k++) {
                    if (parseInt(histo[k] / high * 256) > i) {
                        tempHistoGram[i][k] = 0;
                    } else {
                        tempHistoGram[i][k] = 255;
                    }
                }
            }

            for (var i = 0; i < 256; i++) {     //ìƒí•˜ ë’¤ì§‘ê¸°
                for (var k = 0; k < 256; k++) {
                    m_i = Math.abs(i - inH + 1);
                    histoGram[i][k] = tempHistoGram[m_i][k];
                }
            }

            outImage = histoGram;
            displayImage();
        }

        function histoSt_image() {        // íˆìŠ¤í† ê·¸ë¨
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;
            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);
            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **
            //ê³µì‹
            //out = ((in - low)/(high - low) *255.0)        //ì—°ì‚°ì€ í•­ìƒ ì‹¤ìˆ˜ì²˜ë¦¬ í•´ì„œ ìˆ˜í–‰ í›„ ì •ìˆ˜í™” í•˜ê¸°

            //let low = 255, high = 0; -> ë²„ê·¸ ë°œìƒ í™•ë¥  ìˆìŒ
            var low = inImage[0][0], high = inImage[0][0];
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    if (inImage[i][k] < low)
                        low = inImage[i][k];
                    if (inImage[i][k] > high)
                        high = inImage[i][k];
                }
            }
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    var out = ((inImage[i][k] - low) / (high - low) * 255.0);
                    outImage[i][k] = parseInt(out);
                }
            }
            // *******************************
            displayImage();
        }

        function endIn_image() {        // ì•¤ë“œì¸
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;
            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);
            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **
            //ê³µì‹
            //out = ((in - low)/(high - low) *255.0)        //ì—°ì‚°ì€ í•­ìƒ ì‹¤ìˆ˜ì²˜ë¦¬ í•´ì„œ ìˆ˜í–‰ í›„ ì •ìˆ˜í™” í•˜ê¸°

            //let low = 255, high = 0; -> ë²„ê·¸ ë°œìƒ í™•ë¥  ìˆìŒ
            var low = inImage[0][0], high = inImage[0][0];
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    if (inImage[i][k] < low)
                        low = inImage[i][k];
                    if (inImage[i][k] > high)
                        high = inImage[i][k];
                }
            }
            low += 50;
            high -= 50
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    var out = ((inImage[i][k] - low) / (high - low) * 255.0);
                    outImage[i][k] = parseInt(out);
                }
            }
            // *******************************
            displayImage();
        }

        function histoEqual_image() {       //í‰í™œí™”
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;
            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);
            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **
            //1 ë‹¨ê³„ : íˆìŠ¤í† ê·¸ë¨ ìƒì„±
            var histo = new Array(256);     //íˆìŠ¤í† ê·¸ë¨ ë°ê¸°ì˜ ê°’ì˜ ê°œìˆ˜ê°€ ë“¤ì–´ê°ˆ ë°°ì—´ ìƒì„±
            for (var i = 0; i < 256; i++) {      //ì´ˆê¸°í™”
                histo[i] = 0;
            }

            for (var i = 0; i < inH; i++) {     //inImage ê° ì›ì†Œì˜ ë°ê¸° ë°ì´í„°ì— í•´ë‹¹í•˜ëŠ” íˆìŠ¤í† ê·¸ë¨ì˜ ì›ì†Œê°€ 1ì”© ì¦ê°€
                for (var k = 0; k < inW; k++) {
                    histo[inImage[i][k]]++;
                }
            }


            // 2 ë‹¨ê³„ : ëˆ„ì  íˆìŠ¤í† ê·¸ë¨ ìƒì„±
            var sumHisto = new Array(256);
            for (var i = 0; i < 256; i++) {      //ì´ˆê¸°í™”
                sumHisto[i] = 0;
            }
            var sumValue = 0;
            for (var i = 0; i < 256; i++) {
                sumValue += histo[i];
                sumHisto[i] = sumValue;
            }

            // 3 ë‹¨ê³„ : ì •ê·œí™” ëœ ëˆ„ì í•© ìƒì„±
            //n[i] = sumHisto[i] * (1.0/(inH*inW))*255.0;
            var n = new Array(256);
            for (var i = 0; i < 256; i++) {  //ì´ˆê¸°í™”
                n[i] = 0.0;
            }
            for (var i = 0; i < 256; i++) {     //n ë°°ì—´ì— ì •ê·œí™” ëˆ„ì í•© ê°’ ì…ë ¥(ê° ìë¦¬ì— ì •ê·œí™” ëœ ë°ê¸° ë°ì´í„°ë¥¼ ì…ë ¥)
                n[i] = sumHisto[i] * (1.0 / (inH * inW) * 255.0);
            }

            //ìµœì¢… : ì •ê·œí™” ëœ ëˆ„ì í•©ìœ¼ë¡œ í™”ì†Œì˜ ë°ì´í„°ê°’ ë³€ê²½
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    outImage[i][k] = parseInt(n[inImage[i][k]]);
                    //inImageì˜ ë°ê¸° ë°ì´í„° ê°’ì˜ ìœ„ì¹˜ì— ìˆëŠ” ì •ê·œí™”ëœ ë°ì´í„° ê°’ì„ outImageì— ë„£ëŠ”ë‹¤..
                }
            }
            // *******************************
            displayImage();
        }

        function embos_image() {
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;
            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);
            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **
            // ì§±! ì¤‘ìš”
            var mask = [[-1.0, 0.0, 0.0],
            [0.0, 0.0, 0.0],
            [0.0, 0.0, 1.0]];
            // ì„ì‹œ ì…ë ¥ ë°°ì—´ (ì…ë ¥ë°°ì—´+2) ==> ì‹¤ìˆ˜ ì²˜ë¦¬
            var tmpInImage = new Array(inH + 2);
            for (var i = 0; i < inH + 2; i++)
                tmpInImage[i] = new Array(inW + 2);
            // ì„ì‹œ ì…ë ¥ ì´ˆê¸°í™” (127) --> í‰ê· ê°’? --> ì •ë§ë¡œ í•œì¤„ë„ ëª»ì°¸ëŠ”ë‹¤. (ê°€ì¥ìë¦¬ ê°€ê¹Œìš´ ê°’ìœ¼ë¡œ..)
            for (var i = 0; i < inH + 2; i++)
                for (var k = 0; k < inW + 2; k++)
                    tmpInImage[i][k] = 127.0;
            // ì…ë ¥ ë°°ì—´ --> ì„ì‹œ ì…ë ¥ ë°°ì—´ì˜ ê°€ìš´ë° ì™~ 
            for (var i = 0; i < inH; i++)
                for (var k = 0; k < inW; k++)
                    tmpInImage[i + 1][k + 1] = inImage[i][k];

            // ì„ì‹œ ì¶œë ¥ ë°°ì—´(ì¶œë ¥ë°°ì—´ê³¼ ë™ì¼) ==> ì‹¤ìˆ˜
            var tmpOutImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                tmpOutImage[i] = new Array(outW);
            //** íšŒì„  ì—°ì‚° ** ë§ˆìŠ¤í¬ë¥¼ ì¡ì•„ì„œ ì „ì²´ë¥¼ ê¸ìœ¼ë©´ì„œ ê³„ì‚°í•˜ê¸°...
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    var S = 0.0;
                    for (var m = 0; m < 3; m++)
                        for (var n = 0; n < 3; n++)
                            S += tmpInImage[i + m][k + n] * mask[m][n];
                    tmpOutImage[i][k] = S;
                }
            }
            // í›„ì²˜ë¦¬ : ë§ˆìŠ¤í¬ì˜ í•©ê³„ê°€ 0ì¼ ê²½ìš°.... (ì˜ˆì™¸ ìˆìŒ)
            for (var i = 0; i < outH; i++)
                for (var k = 0; k < outW; k++)
                    tmpOutImage[i][k] += 127.0;
            // ì„ì‹œ ì¶œë ¥ ë°°ì—´ --> ì¶œë ¥ ë°°ì—´
            for (var i = 0; i < outH; i++)
                for (var k = 0; k < outW; k++)
                    outImage[i][k] = parseInt(tmpOutImage[i][k]);
            // *******************************
            displayImage();
        }

        function masking_image() {
            // (ì¤‘ìš”!) ì¶œë ¥ ì˜ìƒì˜ í¬ê¸°ë¥¼ ê²°ì • --> ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¦„.
            outH = inH;
            outW = inW;
            // ì¶œë ¥ ì´ë¯¸ì§€ ë©”ëª¨ë¦¬ í• ë‹¹.
            outImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                outImage[i] = new Array(outW);
            // ** ì§„ì§œ ì˜ìƒì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ **
            // ì§±! ì¤‘ìš”

            // ì„ì‹œ ì…ë ¥ ë°°ì—´ (ì…ë ¥ë°°ì—´+2) ==> ì‹¤ìˆ˜ ì²˜ë¦¬
            var tmpInImage = new Array(inH + 2);
            for (var i = 0; i < inH + 2; i++)
                tmpInImage[i] = new Array(inW + 2);
            // ì„ì‹œ ì…ë ¥ ì´ˆê¸°í™” (127) --> í‰ê· ê°’? --> ì •ë§ë¡œ í•œì¤„ë„ ëª»ì°¸ëŠ”ë‹¤. (ê°€ì¥ìë¦¬ ê°€ê¹Œìš´ ê°’ìœ¼ë¡œ..)
            for (var i = 0; i < inH + 2; i++)
                for (var k = 0; k < inW + 2; k++)
                    tmpInImage[i][k] = 127.0;
            // ì…ë ¥ ë°°ì—´ --> ì„ì‹œ ì…ë ¥ ë°°ì—´ì˜ ê°€ìš´ë° ì™~ 
            for (var i = 0; i < inH; i++)
                for (var k = 0; k < inW; k++)
                    tmpInImage[i + 1][k + 1] = inImage[i][k];

            // ì„ì‹œ ì¶œë ¥ ë°°ì—´(ì¶œë ¥ë°°ì—´ê³¼ ë™ì¼) ==> ì‹¤ìˆ˜
            var tmpOutImage = new Array(outH);
            for (var i = 0; i < outH; i++)
                tmpOutImage[i] = new Array(outW);
            //** íšŒì„  ì—°ì‚° ** ë§ˆìŠ¤í¬ë¥¼ ì¡ì•„ì„œ ì „ì²´ë¥¼ ê¸ìœ¼ë©´ì„œ ê³„ì‚°í•˜ê¸°...
            for (var i = 0; i < inH; i++) {
                for (var k = 0; k < inW; k++) {
                    var S = 0.0;
                    for (var m = 0; m < 3; m++)
                        for (var n = 0; n < 3; n++)
                            S += tmpInImage[i + m][k + n] * mask[m][n];
                    tmpOutImage[i][k] = S;
                }
            }
            // í›„ì²˜ë¦¬ : ë§ˆìŠ¤í¬ì˜ í•©ê³„ê°€ 0ì¼ ê²½ìš°.... (ì˜ˆì™¸ ìˆìŒ)
            var mask_sum = 1.0;
            for (var i = 0; i < 3; i++) {
                for (var k = 0; k < 3; k++) {
                    mask_sum += mask[i][k];
                }
            }
            if (mask_sum == 0.0) {
                for (var i = 0; i < outH; i++)
                    for (var k = 0; k < outW; k++)
                        tmpOutImage[i][k] += 127.0;
            }
            // ì„ì‹œ ì¶œë ¥ ë°°ì—´ --> ì¶œë ¥ ë°°ì—´
            for (var i = 0; i < outH; i++)
                for (var k = 0; k < outW; k++)
                    outImage[i][k] = parseInt(tmpOutImage[i][k]);
            // *******************************
            displayImage();
        }

    </script>
    <style>
        html {
            --byte: 8px;
            --word: 16px;
            --dword: 32px;
            --lword: 64px;
            --base: #d7d7d7;
            --highlight: white;
            --shadow: darkgray;
        }

        @font-face {
            font-family: 'NeoDunggeunmoPro-Regular';
            src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2302@1.0/NeoDunggeunmoPro-Regular.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
        }

        body {
            margin-top: 100px;
            font-family: 'NeoDunggeunmoPro-Regular';
            line-height: 1.6
        }

        /*open file*/
        /*ë ˆì´ë¸” ìŠ¤íƒ€ì¼ ë³€ê²½*/
        .filebox label {
            background-color: #e6e6e6;
            border: 2px solid var(--highlight);
            /*   border-bottom-color: var(--shadow);
            border-right-color: var(--shadow); */
            border-bottom-color: #888;
            border-right-color: #888;
            cursor: pointer;
            font: inherit;
            font-weight: 500;
            font-size: 1.8ch;
            margin: 5px;
            outline: none;
            padding: 5px;
            padding: 5px;
            display: inline-block;
            /* padding: 10px 20px;
            color: #fff;
            vertical-align: middle;
            background-color: #999999;
            cursor: pointer;
            height: 20px;
            margin-left: 5px;
            margin-bottom: 3px; */
        }

        .filebox label:hover {
            background-color: darkgray;
        }

        /*ì›ë˜ ë””ìì¸ ì—†ì• ê¸°*/
        .filebox input[type="file"] {
            position: absolute;
            width: 0;
            height: 0;
            padding: 0;
            overflow: hidden;
            border: 0;
        }

        /*ìº”ë²„ìŠ¤*/
        canvas {
            background-color: #dedede;
            /*border: white 5px solid;*/
            border: 1px solid var(--highlight);
            border-bottom-color: var(--shadow);
            border-right-color: var(--shadow);
            box-shadow: -1px -1px 0 var(--shadow), 1px 1px 0 var(--highlight);
        }

        /*íƒ­ ë©”ë‰´*/
        .container {
            width: 500px;
            margin: 0 auto;

        }

        ul.tabs {
            margin: 0px;
            padding: 0px;
            list-style: none;
        }

        ul.tabs li {
            background: none;
            color: #222;
            display: inline-block;
            padding: 10px 15px;
            cursor: pointer;
        }

        ul.tabs li.current {
            background: #ededed;
            color: #222;
        }

        .tab-content {
            height: 180px;
            display: none;
            background: #ededed;
            padding: 15px;
            text-align: left;
        }

        .tab-content.current {
            display: inherit;
        }

        /*ë²„íŠ¼*/
        button {
            background-color: #e6e6e6;
            border: 2px solid var(--highlight);
            /*   border-bottom-color: var(--shadow);
            border-right-color: var(--shadow); */
            border-bottom-color: #888;
            border-right-color: #888;
            cursor: pointer;
            font: inherit;
            font-weight: 500;
            margin: -1px;
            outline: none;
            padding: var(--word);
        }

        button:hover {
            background-color: darkgray;
        }

        button:active {
            background-color: firebrick;
            border: 2px solid var(--shadow);
            border-bottom-color: var(--highlight);
            border-right-color: var(--highlight);
            color: white;
            outline: none;
        }

        p {
            text-align: center;
            line-height: 0;
        }
    </style>
</HEAD>

<BODY onload="init()">
    <center>
        <h1>ğŸ­SIMPLE RAW PROCESSORğŸ­</h1>
        <h6 title="ì˜ ì•ˆë  ìˆ˜ ìˆìŒ">â˜ºï¸MY LITTLE TINY CUTIE FIRST PROGRAMâ˜ºï¸</h6>

        <div class="filebox">
            <input class="upload-name" value="" placeholder="RAW íŒŒì¼ ì—´ê¸°">
            <label for="inFile">íŒŒì¼ì°¾ê¸°</label>
            <input type="file" accept=".raw" id="inFile" onchange="openRawImage()" />
        </div>

        <canvas id="inCanvas" height="256" width="256"> </canvas>
        <canvas id="outCanvas" height="256" width="256"> </canvas>

        <p>ì›í•˜ëŠ” ì´ë¯¸ì§€ ì²˜ë¦¬ ë°©ì‹ì„ ì„ íƒí•˜ê³  ì ìš©ì„ ì›í•˜ë©´ ì ìš© ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.</p>

        <!-- ë©”ë‰´ ì„ íƒ íƒ­ ì»¨í…Œì´ë„ˆ ë¶€ë¶„ -->
        <div class="container">
            <ul class="tabs"> <!-- íƒ­ ì´ë¦„ -->
                <li class="tab-link current" data-tab="Pixel">í™”ì†Œì  ì²˜ë¦¬</li>
                <li class="tab-link" data-tab="Rotate">íšŒì „</li>
                <li class="tab-link" data-tab="Zoom">í™•ëŒ€Â·ì¶•ì†Œ</li>
                <li class="tab-link" data-tab="Histogram">íˆìŠ¤í† ê·¸ë¨</li>
                <li class="tab-link" data-tab="Masking">ì˜ì—­ì²˜ë¦¬</li>
            </ul>
            <form>
                <!-- 	í™”ì†Œì  ìƒì„¸ë©”ë‰´-->
                <div id="Pixel" class="tab-content current">
                    <input type="radio" name="basic" value="100">ë™ì¼ì˜ìƒ<br>
                    <input type="radio" name="basic" value="101">ë°ê¸°ì¡°ì ˆ<br>
                    <input type="radio" name="basic" value="102">ë°˜ì „<br>
                    <input type="radio" name="basic" value="103">í‘ë°±í™”<br>
                    <input type="radio" name="basic" value="104">í‘ë°±í™”_í‰ê· <br>
                    <input type="radio" name="basic" value="105">í‘ë°±í™”_ì¤‘ê°„ê°’<br>
                    <input type="radio" name="basic" value="999"> íˆ¬ëª…ë„ ì¡°ì ˆ í•˜ê¸°<br>
                </div>
                <!-- 	íšŒì „ ìƒì„¸ë©”ë‰´-->
                <div id="Rotate" class="tab-content">
                    <input type="radio" name="basic" value="201">ì˜¤ë¥¸ìª½ìœ¼ë¡œ 90Ëš<br>
                    <input type="radio" name="basic" value="202">ì˜¤ë¥¸ìª½ìœ¼ë¡œ 180Ëš<br>
                    <input type="radio" name="basic" value="203">ì˜¤ë¥¸ìª½ìœ¼ë¡œ 270Ëš<br>
                    <input type="radio" name="basic" value="221">ìƒí•˜ ë°˜ì „<br>
                    <input type="radio" name="basic" value="222">ì¢Œìš° ë°˜ì „ <br>
                    <!-- <input type="radio" name="basic" value="251">íšŒì „<br> -->
                    <input type="radio" name="basic" value="252">íšŒì „<br> <!-- Në„ -->
                </div>
                <!-- 	í™•ëŒ€ì¶•ì†Œ ìƒì„¸ë©”ë‰´ -->
                <div id="Zoom" class="tab-content">
                    <input type="radio" name="basic" value="301"> 2ë°° í™•ëŒ€ í•˜ê¸° <br>
                    <input type="radio" name="basic" value="302"> 1/2ë¡œ ì¶•ì†Œ í•˜ê¸° <br>
                    <input type="radio" name="basic" value="303"> í™•ëŒ€ í•˜ê¸° <br>
                    <input type="radio" name="basic" value="304"> ì¶•ì†Œ í•˜ê¸° <br>
                </div>
                <!-- 	íˆìŠ¤í† ê·¸ë¨ ìƒì„¸ë©”ë‰´ -->
                <div id="Histogram" class="tab-content">
                    <input type="radio" name="basic" value="400"> íˆìŠ¤í† ê·¸ë¨ ë³´ê¸° <br>
                    <input type="radio" name="basic" value="401"> íˆìŠ¤í† ê·¸ë¨ <br>
                    <input type="radio" name="basic" value="402"> ì•¤ë“œì¸ <br>
                    <input type="radio" name="basic" value="403"> í‰í™œí™” <br>
                </div>
                <!-- 	ë§ˆìŠ¤í‚¹ ìƒì„¸ë©”ë‰´ -->
                <div id="Masking" class="tab-content">
                    <input type="radio" name="basic" value="501"> ì— ë³´ì‹± <br>
                    <input type="radio" name="basic" value="502"> ë¸”ëŸ¬ <br>
                    <input type="radio" name="basic" value="503"> ê°€ìš°ì‹œì•ˆ <br>
                    <input type="radio" name="basic" value="504"> ìœ¤ê³½ì„  ì¶”ì¶œ <br>
                    <input type="radio" name="basic" value="505"> ì„ ëª…í•˜ê²Œ_1 <br>
                    <input type="radio" name="basic" value="506"> ì„ ëª…í•˜ê²Œ_2 <br>
                </div>
                <!-- ì´ˆê¸°í™” ë²„íŠ¼ : resetImage Fnì‹¤í–‰ -->
                <p id="reset"><button type="button" onclick="resetImage()"> ì´ë¯¸ì§€ ì´ˆê¸°í™” </button>
                    <!-- ì ìš© ë²„íŠ¼ : imageSaving Fnì‹¤í–‰ -->
                    <button id="confirm" type="button" onclick="imageSaving(outImage, outH, outW)"> ì ìš© </button>
                </p>
            </form>
</BODY>

</HTML>